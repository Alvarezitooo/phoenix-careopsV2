(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4],{7185:function(e,s,t){Promise.resolve().then(t.bind(t,8299))},8299:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return _}});var a=t(7821),l=t(8078),r=t(9198),n=t(6576);let i=(0,n.Z)("euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);var c=t(6515);let o=(0,n.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var d=t(5118);let u=(0,n.Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),x=(0,n.Z)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var m=t(5758),h=t(9086),p=t(8002);let f=(0,n.Z)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var j=t(1996),b=t(5706),g=t(8304),v=t(8504),N=t(9024);let y=(0,n.Z)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var w=t(750);function D(e){let{onDocumentAnalyzed:s,userId:r}=e,[n,i]=(0,l.useState)(!1),[o,u]=(0,l.useState)(null),[x,m]=(0,l.useState)(null),p=(0,l.useRef)(null),f=async e=>{if(e){if(!["image/jpeg","image/png","image/webp","application/pdf","text/plain"].includes(e.type)){u("Type de fichier non support\xe9. Utilisez JPG, PNG, PDF ou TXT.");return}if(e.size>5242880){u("Le fichier est trop volumineux. Maximum 5MB.");return}i(!0),u(null),m(null);try{let a=new FileReader;a.onload=async a=>{var l;let n=null===(l=a.target)||void 0===l?void 0:l.result,i=e.type.includes("image")?"scan":e.type.includes("pdf")?"pdf":"text",{supabase:c}=await Promise.resolve().then(t.bind(t,9905)),{data:{session:o}}=await c.auth.getSession(),d=null==o?void 0:o.access_token;if(!d)throw Error("Vous devez \xeatre connect\xe9 pour analyser un document");console.log("\uD83D\uDCE4 Upload document avec token:",d.substring(0,20)+"...");let u=await fetch("/api/chat/analyze-document",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(d)},body:JSON.stringify({document:n,userId:r,documentType:i,fileName:e.name})});if(!u.ok)throw Error("Erreur lors de l'analyse du document");let x=await u.json();m("Document analys\xe9 avec succ\xe8s !"),s(x.analysis||x.fullAnalysis)},a.readAsDataURL(e)}catch(e){console.error("Erreur analyse document:",e),u(e.message||"Erreur lors de l'analyse du document")}finally{i(!1)}}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{onDrop:e=>{e.preventDefault();let s=Array.from(e.dataTransfer.files);s.length>0&&f(s[0])},onDragOver:e=>{e.preventDefault()},className:"border-2 border-dashed border-slate-300 rounded-xl p-8 text-center hover:border-rose-400 transition-colors cursor-pointer",onClick:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)("input",{ref:p,type:"file",accept:".jpg,.jpeg,.png,.webp,.pdf,.txt",onChange:e=>{var s;return(null===(s=e.target.files)||void 0===s?void 0:s[0])&&f(e.target.files[0])},className:"hidden"}),n?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(d.Z,{className:"h-12 w-12 text-rose-500 animate-spin mx-auto"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Phoenix analyse votre document..."})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(N.Z,{className:"h-8 w-8 text-slate-400"}),(0,a.jsx)(c.Z,{className:"h-8 w-8 text-slate-400"}),(0,a.jsx)(y,{className:"h-8 w-8 text-slate-400"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-700 font-medium",children:"Glissez votre document ici ou cliquez pour choisir"}),(0,a.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:"Notification MDPH, certificat m\xe9dical, courrier CAF..."}),(0,a.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"JPG, PNG, PDF, TXT • Max 5MB"})]})]})]}),o&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-red-600 bg-red-50 p-3 rounded-lg",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm",children:o})]}),x&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-green-600 bg-green-50 p-3 rounded-lg",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm",children:x})]}),(0,a.jsxs)("div",{className:"text-xs text-slate-500",children:[(0,a.jsx)("p",{className:"font-medium mb-2",children:"Phoenix peut analyser :"}),(0,a.jsxs)("ul",{className:"space-y-1",children:[(0,a.jsx)("li",{children:"• Notifications et d\xe9cisions MDPH"}),(0,a.jsx)("li",{children:"• Certificats m\xe9dicaux et bilans"}),(0,a.jsx)("li",{children:"• Courriers CAF et organismes"}),(0,a.jsx)("li",{children:"• Formulaires de demande d'aides"}),(0,a.jsx)("li",{children:"• Documents scolaires (PPS, PAI...)"})]})]})]})}let k=(0,n.Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function C(){let[e,s]=(0,l.useState)(null),t=[{id:"contextual-help",title:"Dashboard → Chat contextuel",description:"Chaque bouton du dashboard lance une question pr\xe9-remplie dans le chat",steps:[{icon:i,text:"Clic sur aide AEEH",color:"bg-green-100 text-green-600"},{icon:p.Z,text:"Ouvre le chat",color:"bg-rose-100 text-rose-600"},{icon:x,text:"Question d\xe9j\xe0 pr\xeate",color:"bg-purple-100 text-purple-600"}]},{id:"document-upload",title:"Upload document (exp\xe9rimental)",description:"Analysez un document avec Phoenix IA",steps:[{icon:c.Z,text:"Upload fichier",color:"bg-blue-100 text-blue-600"},{icon:x,text:"Analyse IA",color:"bg-purple-100 text-purple-600"},{icon:p.Z,text:"R\xe9sultat affich\xe9",color:"bg-rose-100 text-rose-600"}]},{id:"real-alerts",title:"Alertes automatiques",description:"Affiche les \xe9ch\xe9ances \xe0 moins de 7 jours depuis Supabase",steps:[{icon:o,text:"Deadline Supabase",color:"bg-orange-100 text-orange-600"},{icon:x,text:"Calcul J-7",color:"bg-purple-100 text-purple-600"},{icon:p.Z,text:'Bouton "Demander aide"',color:"bg-rose-100 text-rose-600"}]}];return(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"\uD83D\uDD17 Fonctionnalit\xe9s actuelles"}),(0,a.jsx)("div",{className:"space-y-4",children:t.map(t=>(0,a.jsxs)("div",{className:"border border-slate-200 rounded-lg p-4",children:[(0,a.jsx)("button",{onClick:()=>s(e===t.id?null:t.id),className:"w-full text-left",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-slate-900",children:t.title}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:t.description})]}),(0,a.jsx)(k,{className:"h-5 w-5 text-slate-400 transition-transform ".concat(e===t.id?"rotate-90":"")})]})}),e===t.id&&(0,a.jsx)("div",{className:"mt-4 flex items-center space-x-2 overflow-x-auto pb-2",children:t.steps.map((e,s)=>{let l=e.icon;return(0,a.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat(e.color),children:(0,a.jsx)(l,{className:"h-4 w-4"})}),(0,a.jsx)("span",{className:"text-sm font-medium text-slate-700 whitespace-nowrap",children:e.text}),s<t.steps.length-1&&(0,a.jsx)(k,{className:"h-4 w-4 text-slate-300 mx-2"})]},s)})})]},t.id))}),(0,a.jsx)("div",{className:"mt-6 p-4 bg-gradient-to-r from-rose-50 to-purple-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(x,{className:"h-5 w-5 text-purple-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-slate-900",children:"Chat IA avec contexte"}),(0,a.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Le chat re\xe7oit automatiquement vos donn\xe9es (aides, documents, \xe9ch\xe9ances) pour des r\xe9ponses personnalis\xe9es."})]})]})})]})}var A=t(9905),P=t(432),S=t(961);let Z=(0,n.Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function M(e){let{onComplete:s}=e,{user:t}=(0,b.K)(),n=(0,v.useRouter)(),[i,c]=(0,l.useState)(1),[o,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)({name:"",departement:"",situation:"parent_solo"}),[f,j]=(0,l.useState)([{name:"",age:"",handicap_type:""}]),g=e=>{f.length>1&&j(f.filter((s,t)=>t!==e))},N=(e,s,t)=>{let a=[...f];a[e]={...a[e],[s]:t},j(a)},y=()=>{switch(i){case 1:default:return!0;case 2:return""!==h.name.trim();case 3:return f.some(e=>""!==e.name.trim());case 4:return""!==h.departement.trim()}},w=async()=>{u(!0);try{if(!t)throw Error("Non connect\xe9");let{data:e,error:a}=await A.supabase.from("family_profiles").insert([{user_id:t.id,name:h.name,departement:h.departement,situation:h.situation,nb_enfants:f.filter(e=>""!==e.name.trim()).length}]).select().single();if(a)throw a;let l=f.filter(e=>""!==e.name.trim()).map(s=>({family_id:e.id,name:s.name,age:""===s.age?null:Number(s.age),handicap_type:s.handicap_type}));if(l.length>0){let{error:e}=await A.supabase.from("children").insert(l);if(e)throw e}s?s():(n.push("/dashboard"),n.refresh())}catch(e){console.error("Erreur onboarding:",e),alert("Erreur lors de la sauvegarde. R\xe9essayez.")}finally{u(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-rose-50 via-white to-purple-50 z-50 overflow-auto",children:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-rose-100 rounded-full mb-4",children:(0,a.jsx)(P.Z,{className:"h-8 w-8 text-rose-500"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Bienvenue sur Phoenix"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Prenons quelques instants pour personnaliser votre exp\xe9rience"})]}),(0,a.jsx)("div",{className:"flex items-center justify-center space-x-2 mb-8",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"h-2 rounded-full transition-all ".concat(e<=i?"w-12 bg-rose-500":"w-8 bg-slate-200")},e))}),1===i&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(x,{className:"h-12 w-12 text-purple-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-slate-900 mb-4",children:"Phoenix vous accompagne"}),(0,a.jsx)("p",{className:"text-slate-600 text-lg mb-6",children:"Pour vous aider au mieux, Phoenix a besoin de comprendre votre situation familiale."}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"\uD83D\uDD12 Vos donn\xe9es sont priv\xe9es"})," : Elles restent dans votre espace personnel et permettent \xe0 Phoenix de personnaliser ses r\xe9ponses \xe0 votre situation."]})})]})}),2===i&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)(r.Z,{className:"h-12 w-12 text-rose-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Parlons de vous"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Comment souhaitez-vous \xeatre appel\xe9(e) ?"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Votre nom ou pr\xe9nom"}),(0,a.jsx)("input",{type:"text",value:h.name,onChange:e=>p({...h,name:e.target.value}),placeholder:"Ex: Marie, Thomas...",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent text-lg",autoFocus:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Votre situation familiale"}),(0,a.jsxs)("select",{value:h.situation,onChange:e=>p({...h,situation:e.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent text-lg",children:[(0,a.jsx)("option",{value:"parent_solo",children:"Parent solo"}),(0,a.jsx)("option",{value:"couple",children:"En couple"}),(0,a.jsx)("option",{value:"autre",children:"Autre"})]})]})]}),3===i&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)(S.Z,{className:"h-12 w-12 text-rose-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Vos enfants"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Parlez-nous de votre ou vos enfants"})]}),f.map((e,s)=>(0,a.jsxs)("div",{className:"border border-slate-200 rounded-lg p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"font-medium text-slate-900",children:["Enfant ",s+1]}),f.length>1&&(0,a.jsx)("button",{onClick:()=>g(s),className:"text-red-500 hover:text-red-700 text-sm",children:"Retirer"})]}),(0,a.jsx)("input",{type:"text",value:e.name,onChange:e=>N(s,"name",e.target.value),placeholder:"Pr\xe9nom de l'enfant",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("input",{type:"number",value:e.age,onChange:e=>N(s,"age",""===e.target.value?"":parseInt(e.target.value)),placeholder:"\xc2ge",min:"0",max:"30",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"}),(0,a.jsx)("input",{type:"text",value:e.handicap_type,onChange:e=>N(s,"handicap_type",e.target.value),placeholder:"Type de handicap",className:"px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent"})]})]},s)),(0,a.jsx)("button",{onClick:()=>{j([...f,{name:"",age:"",handicap_type:""}])},className:"w-full py-2 border-2 border-dashed border-slate-300 rounded-lg text-slate-600 hover:border-rose-400 hover:text-rose-600 transition-colors",children:"+ Ajouter un autre enfant"})]}),4===i&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)(m.Z,{className:"h-12 w-12 text-rose-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Votre d\xe9partement"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Les aides et d\xe9marches varient selon votre d\xe9partement"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Num\xe9ro de d\xe9partement"}),(0,a.jsx)("input",{type:"text",value:h.departement,onChange:e=>p({...h,departement:e.target.value}),placeholder:"Ex: 75 (Paris), 69 (Rh\xf4ne), 13 (Bouches-du-Rh\xf4ne)...",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent text-lg",autoFocus:!0})]}),(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-sm text-green-800",children:[(0,a.jsx)("strong",{children:"✅ C'est presque termin\xe9 !"})," Phoenix est maintenant pr\xeat \xe0 vous accompagner avec des r\xe9ponses personnalis\xe9es \xe0 votre situation."]})})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-8 pt-6 border-t border-slate-200",children:[i>1?(0,a.jsxs)("button",{onClick:()=>c(i-1),className:"flex items-center space-x-2 px-4 py-2 text-slate-600 hover:text-slate-900 transition-colors",children:[(0,a.jsx)(Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Retour"})]}):(0,a.jsx)("div",{}),i<4?(0,a.jsxs)("button",{onClick:()=>c(i+1),disabled:!y(),className:"flex items-center space-x-2 px-6 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)("span",{children:"Continuer"}),(0,a.jsx)(k,{className:"h-5 w-5"})]}):(0,a.jsx)("button",{onClick:w,disabled:!y()||o,className:"flex items-center space-x-2 px-6 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 animate-spin"}),(0,a.jsx)("span",{children:"Finalisation..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"Commencer"}),(0,a.jsx)(x,{className:"h-5 w-5"})]})})]})]})})})}var E=t(6446);function _(){let{user:e}=(0,b.K)(),s=(0,v.useRouter)(),[n,N]=(0,l.useState)(!1),[y,w]=(0,l.useState)("resume"),[k,A]=(0,l.useState)(null),[P,S]=(0,l.useState)(!1),[Z,_]=(0,l.useState)(!1),[q,z]=(0,l.useState)(!1),[I,T]=(0,l.useState)(!1),[F,R]=(0,l.useState)(!1),{aides:H,loading:V}=(0,g.fN)(),{documents:B,loading:J}=(0,g.GK)(),{deadlines:G,loading:O}=(0,g.hT)(),{profile:U,children:L,loading:K}=(0,g.mH)(),Q=e=>{let t=encodeURIComponent(e);s.push("/chat?q=".concat(t))},X=e=>{switch(e){case"actif":case"valide":return"text-green-600 bg-green-50";case"en_attente":case"expire_bientot":return"text-orange-600 bg-orange-50";case"refuse":case"expire":return"text-red-600 bg-red-50";default:return"text-slate-600 bg-slate-50"}},Y=e=>{switch(e){case"haute":return"text-red-600 bg-red-50";case"moyenne":return"text-orange-600 bg-orange-50";case"basse":return"text-blue-600 bg-blue-50";default:return"text-slate-600 bg-slate-50"}},W=e=>{switch(e){case"renouvellement":return"\uD83D\uDD04";case"rdv":return"\uD83D\uDC65";case"demarche":return"\uD83D\uDCCB";default:return"\uD83D\uDCC5"}},$=e=>{let s=new Date;return Math.ceil((new Date(e).getTime()-s.getTime())/864e5)},ee=e=>e<0?"text-red-700 bg-red-100":e<=7?"text-red-600 bg-red-50":e<=30?"text-orange-600 bg-orange-50":"text-slate-600 bg-slate-50",es=!V&&!J&&!(null==H?void 0:H.length)&&!(null==B?void 0:B.length)&&!(null==G?void 0:G.length),et=[{id:"resume",label:"R\xe9sum\xe9",icon:r.Z},{id:"aides",label:"Mes Aides",icon:i},{id:"documents",label:"Documents",icon:c.Z},{id:"planning",label:"Planning",icon:o}];return(K||U||Z||_(!0),K)?(0,a.jsx)("div",{className:"h-full bg-slate-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(d.Z,{className:"h-12 w-12 text-rose-500 animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Chargement de votre dossier..."})]})}):Z?(0,a.jsx)(M,{onComplete:()=>{_(!1),s.refresh()}}):(0,a.jsxs)("div",{className:"h-full bg-slate-50 overflow-auto",children:[(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"mb-8 flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Mon Dossier Familial"}),(0,a.jsxs)("p",{className:"text-slate-600 mt-2",children:["Bienvenue ",(null==e?void 0:e.email)||(null==U?void 0:U.name),", voici un aper\xe7u de votre situation"]})]}),(0,a.jsxs)("button",{onClick:()=>s.push("/profil"),className:"flex items-center space-x-2 px-4 py-2 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[(0,a.jsx)(u,{className:"h-4 w-4 text-slate-600"}),(0,a.jsx)("span",{className:"text-slate-700 font-medium",children:"Mon Profil"})]})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"hidden md:flex space-x-1 bg-white rounded-xl p-1 shadow-sm",children:et.map(e=>{let s=e.icon;return(0,a.jsxs)("button",{onClick:()=>w(e.id),className:"flex items-center space-x-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ".concat(y===e.id?"bg-rose-500 text-white shadow-md":"text-slate-600 hover:bg-slate-100"),children:[(0,a.jsx)(s,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:e.label})]},e.id)})}),(0,a.jsx)("div",{className:"md:hidden bg-white rounded-xl shadow-sm",children:(0,a.jsx)("select",{value:y,onChange:e=>w(e.target.value),className:"w-full px-4 py-3 rounded-xl border-0 font-medium text-slate-900 focus:ring-2 focus:ring-rose-500",children:et.map(e=>(0,a.jsx)("option",{value:e.id,children:e.label},e.id))})})]}),"resume"===y&&(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[es&&!F&&(0,a.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 via-rose-500 to-pink-500 rounded-2xl p-6 md:p-8 text-white shadow-xl animate-fadeIn",children:[(0,a.jsxs)("h2",{className:"text-2xl md:text-3xl font-bold mb-3",children:["\uD83D\uDC4B Bienvenue ",null==U?void 0:U.name," !"]}),(0,a.jsx)("p",{className:"text-purple-50 mb-6",children:"Phoenix est pr\xeat \xe0 vous aider. Voici comment d\xe9marrer :"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-3 mb-4",children:[(0,a.jsxs)("button",{onClick:()=>s.push("/chat?q=Quelles aides puis-je demander pour mon enfant ?"),className:"bg-white/20 hover:bg-white/30 p-4 rounded-xl text-left transition-all duration-200 hover:scale-105 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCB0"}),(0,a.jsx)("div",{className:"font-semibold mb-1",children:"D\xe9couvrir mes aides"}),(0,a.jsx)("div",{className:"text-sm text-purple-100",children:"AEEH, PCH, AJPP..."})]}),(0,a.jsxs)("button",{onClick:()=>N(!0),className:"bg-white/20 hover:bg-white/30 p-4 rounded-xl text-left transition-all duration-200 hover:scale-105 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCC4"}),(0,a.jsx)("div",{className:"font-semibold mb-1",children:"Analyser un document"}),(0,a.jsx)("div",{className:"text-sm text-purple-100",children:"Notification MDPH..."})]}),(0,a.jsxs)("button",{onClick:()=>s.push("/chat"),className:"bg-white/20 hover:bg-white/30 p-4 rounded-xl text-left transition-all duration-200 hover:scale-105 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCAC"}),(0,a.jsx)("div",{className:"font-semibold mb-1",children:"Poser une question"}),(0,a.jsx)("div",{className:"text-sm text-purple-100",children:"Phoenix r\xe9pond \xe0 tout"})]})]}),(0,a.jsx)("button",{onClick:()=>R(!0),className:"text-white/80 hover:text-white text-sm underline transition-colors",children:"Masquer ce message"})]}),!es&&((null==H?void 0:H.length)>0||(null==G?void 0:G.length)>0)&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl p-6 text-white shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,a.jsx)(x,{className:"h-6 w-6 flex-shrink-0 mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-2",children:"\uD83D\uDCCA Votre situation en un coup d'œil"}),P?(0,a.jsxs)("div",{className:"space-y-2 animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-white/20 rounded w-3/4"}),(0,a.jsx)("div",{className:"h-4 bg-white/20 rounded w-1/2"})]}):k?(0,a.jsx)("div",{className:"bg-white/10 backdrop-blur rounded-lg p-4 text-sm prose prose-invert prose-sm max-w-none",children:(0,a.jsx)(E.UG,{children:k})}):(0,a.jsxs)("div",{className:"space-y-2 text-sm text-blue-50",children:[(0,a.jsxs)("p",{children:["✅ Vous avez ",(null==H?void 0:H.length)||0," aide(s) active(s)"]}),(null==G?void 0:G.filter(e=>30>=$(e.date)).length)>0&&(0,a.jsxs)("p",{children:["⚠️ ",G.filter(e=>30>=$(e.date)).length," \xe9ch\xe9ance(s) ce mois-ci"]})]})]})]}),(0,a.jsx)("button",{onClick:()=>s.push("/chat?q=Explique-moi ma situation en d\xe9tail"),className:"bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105",children:"\uD83D\uDCAC Discuter avec Phoenix"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm transition-all duration-200 hover:shadow-md",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-900 mb-4",children:"\uD83D\uDC68‍\uD83D\uDC69‍\uD83D\uDC67‍\uD83D\uDC66 Ma Famille"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(r.Z,{className:"h-5 w-5 text-slate-400"}),(0,a.jsxs)("span",{className:"text-slate-700",children:[(null==U?void 0:U.name)||(null==e?void 0:e.email)," - Parent r\xe9f\xe9rent"]})]}),null==L?void 0:L.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDC76"}),(0,a.jsxs)("span",{className:"text-slate-700",children:[e.name," (",e.age," ans",e.handicap_type?", ".concat(e.handicap_type):"",")"]})]},e.id)),U&&(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 text-slate-400"}),(0,a.jsxs)("span",{className:"text-slate-500",children:["Situation: ",U.situation||"Non renseign\xe9",U.departement&&" • ".concat(U.departement)]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(C,{}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"\uD83D\uDEA8 Alertes"}),(0,a.jsx)("div",{className:"space-y-3",children:(null==G?void 0:G.filter(e=>7>=$(e.date)).length)>0?G.filter(e=>7>=$(e.date)).map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-3 bg-orange-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5 text-orange-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-orange-800",children:e.titre}),(0,a.jsx)("p",{className:"text-xs text-orange-600",children:0===$(e.date)?"Aujourd'hui":1===$(e.date)?"Demain":"Dans ".concat($(e.date)," jours")})]})]}),(0,a.jsx)("button",{onClick:()=>Q("Aide-moi pour : ".concat(e.titre)),className:"p-1 text-orange-600 hover:text-orange-800 hover:bg-orange-100 rounded transition-colors",title:"Demander aide \xe0 Phoenix",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})]},e.id)):(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"Aucune alerte pour le moment ✅"})})]})]})]}),"aides"===y&&(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"\uD83D\uDCB0 Mes Aides et Allocations"}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsx)("button",{onClick:()=>Q("Quelles autres aides puis-je demander pour ma situation ?"),className:"px-4 py-2 border border-rose-500 text-rose-600 rounded-lg hover:bg-rose-50 transition-all duration-200",children:"\uD83D\uDCA1 D\xe9couvrir"}),(0,a.jsx)("button",{onClick:()=>z(!0),className:"bg-rose-500 text-white px-4 py-2 rounded-lg hover:bg-rose-600 transition-all duration-200 hover:scale-105",children:"+ Ajouter une aide"})]})]}),(0,a.jsx)("div",{className:"grid gap-4",children:V?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(d.Z,{className:"h-8 w-8 text-rose-500 animate-spin mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Chargement de vos aides..."})]}):(null==H?void 0:H.length)>0?H.map(e=>(0,a.jsx)("div",{className:"border border-slate-200 rounded-lg p-4 hover:bg-slate-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:e.nom}),(0,a.jsx)("p",{className:"text-slate-600",children:e.montant}),e.echeance&&(0,a.jsxs)("p",{className:"text-xs text-orange-600 mt-1",children:["\xc9ch\xe9ance: ",new Date(e.echeance).toLocaleDateString("fr-FR")]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(X(e.statut)),children:e.statut.replace("_"," ")}),(0,a.jsx)("button",{onClick:()=>Q("Comment renouveler ou optimiser mon aide ".concat(e.nom," ?")),className:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-lg transition-colors",title:"Demander \xe0 Phoenix",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})]})]})},e.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-slate-600",children:"Aucune aide enregistr\xe9e pour le moment."}),(0,a.jsx)("button",{onClick:()=>Q("Quelles aides puis-je demander pour ma situation familiale ?"),className:"mt-4 text-rose-600 hover:text-rose-700 font-medium",children:"D\xe9couvrir les aides disponibles"})]})})]}),"documents"===y&&(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"\uD83D\uDCC4 Mes Documents"}),(0,a.jsx)("button",{onClick:()=>N(!0),className:"bg-rose-500 text-white px-4 py-2 rounded-lg hover:bg-rose-600 transition-colors",children:"+ Ajouter document"})]}),(0,a.jsx)("div",{className:"grid gap-4",children:J?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(d.Z,{className:"h-8 w-8 text-rose-500 animate-spin mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Chargement de vos documents..."})]}):(null==B?void 0:B.length)>0?B.map(e=>(0,a.jsx)("div",{className:"border border-slate-200 rounded-lg p-4 hover:bg-slate-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5 text-slate-400 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:e.nom}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:[e.type," • ",e.date]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(X(e.statut)),children:e.statut.replace("_"," ")}),(0,a.jsx)("button",{onClick:()=>Q("Peux-tu m'expliquer ce document ".concat(e.nom," et me dire ce que je dois faire ?")),className:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-lg transition-colors",title:"Analyser avec Phoenix",children:(0,a.jsx)(f,{className:"h-4 w-4"})})]})]})},e.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-slate-600",children:"Aucun document pour le moment."}),(0,a.jsx)("button",{onClick:()=>N(!0),className:"mt-4 text-rose-600 hover:text-rose-700 font-medium",children:"Ajouter votre premier document"})]})})]}),"planning"===y&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-red-100 p-2 rounded-lg",children:(0,a.jsx)(h.Z,{className:"h-5 w-5 text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Urgences"}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-900",children:(null==G?void 0:G.filter(e=>7>=$(e.date)).length)||0})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-orange-100 p-2 rounded-lg",children:(0,a.jsx)(j.Z,{className:"h-5 w-5 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Ce mois-ci"}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-900",children:(null==G?void 0:G.filter(e=>30>=$(e.date)&&$(e.date)>0).length)||0})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-2 rounded-lg",children:(0,a.jsx)(o,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"\xc0 venir"}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-900",children:(null==G?void 0:G.filter(e=>$(e.date)>30).length)||0})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"\uD83D\uDCC5 Prochaines \xc9ch\xe9ances"}),(0,a.jsx)("button",{onClick:()=>T(!0),className:"bg-rose-500 text-white px-4 py-2 rounded-lg hover:bg-rose-600 transition-all duration-200 hover:scale-105",children:"+ Ajouter \xe9ch\xe9ance"})]}),(0,a.jsx)("div",{className:"space-y-3",children:O?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(d.Z,{className:"h-8 w-8 text-rose-500 animate-spin mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Chargement de vos \xe9ch\xe9ances..."})]}):(null==G?void 0:G.length)>0?G.sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()).map(e=>{let s=$(e.date);return(0,a.jsx)("div",{className:"border border-slate-200 rounded-lg p-4 hover:bg-slate-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,a.jsx)("span",{className:"text-2xl",children:W(e.type)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:e.titre}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,a.jsx)("p",{className:"text-sm text-slate-600",children:new Date(e.date).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(Y(e.priorite)),children:e.priorite})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(ee(s)),children:s<0?"Pass\xe9 de ".concat(Math.abs(s)," jour").concat(Math.abs(s)>1?"s":""):0===s?"Aujourd'hui":1===s?"Demain":"Dans ".concat(s," jours")}),(0,a.jsx)("button",{onClick:()=>Q("Comment pr\xe9parer et r\xe9ussir : ".concat(e.titre," ? Quels documents et d\xe9marches ?")),className:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-lg transition-colors",title:"Aide de Phoenix",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})]})]})},e.id)}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-slate-600",children:"Aucune \xe9ch\xe9ance programm\xe9e."}),(0,a.jsx)("button",{onClick:()=>Q("Quelles sont les d\xe9marches importantes \xe0 pr\xe9voir pour ma situation ?"),className:"mt-4 text-rose-600 hover:text-rose-700 font-medium",children:"Planifier mes prochaines d\xe9marches"})]})})]})]})]}),q&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-slate-900",children:"\uD83D\uDCB0 Ajouter une aide"}),(0,a.jsx)("button",{onClick:()=>z(!1),className:"text-slate-400 hover:text-slate-600 text-2xl leading-none",children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:async a=>{a.preventDefault();let l=new FormData(a.currentTarget),r=l.get("nom"),n=l.get("montant"),i=l.get("statut"),c=l.get("echeance");try{let{supabase:a}=await Promise.resolve().then(t.bind(t,9905)),{error:l}=await a.from("user_aides").insert([{user_id:null==e?void 0:e.id,nom:r,montant:n,statut:i,echeance:c||null}]);if(l)throw l;z(!1),s.refresh()}catch(e){console.error("Erreur ajout aide:",e),alert("Erreur lors de l&apos;ajout de l&apos;aide")}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nom de l'aide *"}),(0,a.jsx)("input",{type:"text",name:"nom",placeholder:"Ex: AEEH Base, PCH, AAH...",required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Montant"}),(0,a.jsx)("input",{type:"text",name:"montant",placeholder:"Ex: 142€/mois, 1200€/an...",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Statut *"}),(0,a.jsxs)("select",{name:"statut",required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all",children:[(0,a.jsx)("option",{value:"actif",children:"✅ Actif"}),(0,a.jsx)("option",{value:"en_attente",children:"⏳ En attente"}),(0,a.jsx)("option",{value:"refuse",children:"❌ Refus\xe9"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date d'\xe9ch\xe9ance (optionnel)"}),(0,a.jsx)("input",{type:"date",name:"echeance",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>z(!1),className:"flex-1 px-4 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-all",children:"Annuler"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-all font-medium",children:"Ajouter l'aide"})]})]})]})}),I&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-slate-900",children:"\uD83D\uDCC5 Ajouter une \xe9ch\xe9ance"}),(0,a.jsx)("button",{onClick:()=>T(!1),className:"text-slate-400 hover:text-slate-600 text-2xl leading-none",children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:async a=>{a.preventDefault();let l=new FormData(a.currentTarget),r=l.get("titre"),n=l.get("date"),i=l.get("type"),c=l.get("priorite");try{let{supabase:a}=await Promise.resolve().then(t.bind(t,9905)),{error:l}=await a.from("user_deadlines").insert([{user_id:null==e?void 0:e.id,titre:r,date:n,type:i,priorite:c}]);if(l)throw l;T(!1),s.refresh()}catch(e){console.error("Erreur ajout \xe9ch\xe9ance:",e),alert("Erreur lors de l&apos;ajout de l&apos;\xe9ch\xe9ance")}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Titre *"}),(0,a.jsx)("input",{type:"text",name:"titre",placeholder:"Ex: RDV MDPH, Renouvellement AEEH...",required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Date *"}),(0,a.jsx)("input",{type:"date",name:"date",required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Type *"}),(0,a.jsxs)("select",{name:"type",required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all",children:[(0,a.jsx)("option",{value:"rdv",children:"\uD83D\uDC65 Rendez-vous"}),(0,a.jsx)("option",{value:"renouvellement",children:"\uD83D\uDD04 Renouvellement"}),(0,a.jsx)("option",{value:"demarche",children:"\uD83D\uDCCB D\xe9marche administrative"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Priorit\xe9 *"}),(0,a.jsxs)("select",{name:"priorite",required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent transition-all",children:[(0,a.jsx)("option",{value:"haute",children:"\uD83D\uDD34 Haute"}),(0,a.jsx)("option",{value:"moyenne",children:"\uD83D\uDFE1 Moyenne"}),(0,a.jsx)("option",{value:"basse",children:"\uD83D\uDD35 Basse"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>T(!1),className:"flex-1 px-4 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-all",children:"Annuler"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-all font-medium",children:"Cr\xe9er l'\xe9ch\xe9ance"})]})]})]})}),n&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-lg w-full max-h-96 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Analyser un document"}),(0,a.jsx)("button",{onClick:()=>N(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),(0,a.jsx)(D,{onDocumentAnalyzed:e=>{N(!1)},userId:(null==e?void 0:e.id)||""})]})})]})}t(2949)},5706:function(e,s,t){"use strict";t.d(s,{H:function(){return i},K:function(){return c}});var a=t(7821),l=t(8078),r=t(9905);let n=(0,l.createContext)(void 0);function i(e){let{children:s}=e,[t,i]=(0,l.useState)(null),[c,o]=(0,l.useState)(null),[d,u]=(0,l.useState)(!0);(0,l.useEffect)(()=>{r.supabase.auth.getSession().then(e=>{var s;let{data:{session:t}}=e;o(t),i(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),u(!1)});let{data:{subscription:e}}=r.supabase.auth.onAuthStateChange((e,s)=>{var t;o(s),i(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),u(!1)});return()=>e.unsubscribe()},[]);let x=async(e,s,t)=>{let{data:a,error:l}=await r.supabase.auth.signUp({email:e,password:s,options:{data:{name:t}}});return{data:a,error:l}},m=async(e,s)=>{let{data:t,error:a}=await r.supabase.auth.signInWithPassword({email:e,password:s});return{data:t,error:a}},h=async()=>{await r.supabase.auth.signOut()},p=async e=>{let{data:s,error:t}=await r.supabase.auth.resetPasswordForEmail(e);return{data:s,error:t}};return(0,a.jsx)(n.Provider,{value:{user:t,session:c,loading:d,signUp:x,signIn:m,signOut:h,resetPassword:p},children:s})}function c(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useSupabaseAuth must be used within an AuthProvider");return e}},8304:function(e,s,t){"use strict";t.d(s,{GK:function(){return i},fN:function(){return n},hT:function(){return c},mH:function(){return o}});var a=t(8078),l=t(9905),r=t(5706);function n(){let{user:e}=(0,r.K)(),[s,t]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!e){i(!1);return}(async()=>{try{let{data:s,error:a}=await l.supabase.from("user_aides").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(a)throw a;t(s||[])}catch(e){o(e.message)}finally{i(!1)}})()},[e]),{aides:s,loading:n,error:c}}function i(){let{user:e}=(0,r.K)(),[s,t]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!e){i(!1);return}(async()=>{try{let{data:s,error:a}=await l.supabase.from("user_documents").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(a)throw a;t(s||[])}catch(e){o(e.message)}finally{i(!1)}})()},[e]),{documents:s,loading:n,error:c}}function c(){let{user:e}=(0,r.K)(),[s,t]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[c,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!e){i(!1);return}(async()=>{try{let{data:s,error:a}=await l.supabase.from("user_deadlines").select("*").eq("user_id",e.id).order("date",{ascending:!0});if(a)throw a;t(s||[])}catch(e){o(e.message)}finally{i(!1)}})()},[e]),{deadlines:s,loading:n,error:c}}function o(){let{user:e}=(0,r.K)(),[s,t]=(0,a.useState)(null),[n,i]=(0,a.useState)([]),[c,o]=(0,a.useState)(!0),[d,u]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!e){o(!1);return}(async()=>{try{let{data:s,error:a}=await l.supabase.from("family_profiles").select("*").eq("user_id",e.id).single();if(a&&"PGRST116"!==a.code)throw a;if(t(s),s){let{data:e,error:t}=await l.supabase.from("children").select("*").eq("family_id",s.id);if(t)throw t;i(e||[])}}catch(e){u(e.message)}finally{o(!1)}})()},[e]),{profile:s,children:n,loading:c,error:d}}},9905:function(e,s,t){"use strict";t.d(s,{supabase:function(){return n}});var a=t(1620);let l="https://gvginoszwaccifrtackh.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd2Z2lub3N6d2FjY2lmcnRhY2toIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxMjQyNzgsImV4cCI6MjA3NDcwMDI3OH0.sbuGET5VLfo0VjwVugc_ix1F_b0ntqDVmrqckdP22ss";if(!l||!r)throw Error("Missing Supabase environment variables");let n=(0,a.eI)(l,r,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce",storage:{getItem:e=>{var s;return(null===(s=document.cookie.split("; ").find(s=>s.startsWith("".concat(e,"="))))||void 0===s?void 0:s.split("=")[1])||null},setItem:(e,s)=>{document.cookie="".concat(e,"=").concat(s,"; path=/; max-age=31536000; SameSite=Lax")},removeItem:e=>{document.cookie="".concat(e,"=; path=/; max-age=0")}}}})},1996:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(6576).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},5758:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(6576).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},8002:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(6576).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},9024:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(6576).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},9198:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(6576).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},961:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(6576).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])}},function(e){e.O(0,[129,835,115,571,744],function(){return e(e.s=7185)}),_N_E=e.O()}]);