(()=>{var e={};e.id=619,e.ids=[619],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},9411:e=>{"use strict";e.exports=require("node:path")},7742:e=>{"use strict";e.exports=require("node:process")},1041:e=>{"use strict";e.exports=require("node:url")},7214:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c}),t(9290),t(5474),t(2874),t(1163);var r=t(7105),a=t(5265),n=t(157),o=t.n(n),i=t(4665),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(s,l);let c=["",{children:["(protected)",{children:["chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,9290)),"/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/(protected)/chat/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5474)),"/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/(protected)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,2874,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1163)),"/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,2874,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/(protected)/chat/page.tsx"],u="/(protected)/chat/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(protected)/chat/page",pathname:"/chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4669:(e,s,t)=>{Promise.resolve().then(t.bind(t,2036))},8306:(e,s,t)=>{Promise.resolve().then(t.bind(t,5712))},4533:(e,s,t)=>{Promise.resolve().then(t.bind(t,2341))},8067:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,3817,23)),Promise.resolve().then(t.t.bind(t,9323,23)),Promise.resolve().then(t.t.bind(t,2204,23)),Promise.resolve().then(t.t.bind(t,820,23)),Promise.resolve().then(t.t.bind(t,5915,23)),Promise.resolve().then(t.t.bind(t,1611,23))},2036:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var r=t(9899),a=t(5507),n=t(7866),o=t(8954),i=t(2979),l=t(3228),c=t(1278);let d=(0,c.Z)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var u=t(9587);let m=(0,c.Z)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var x=t(5460);let h={errors:{UNKNOWN_ERROR:"Une erreur inattendue est survenue. L'\xe9quipe technique a \xe9t\xe9 pr\xe9venue.",DB_FETCH_FAILED:"Je n'arrive pas \xe0 acc\xe9der aux informations pour le moment. Veuillez r\xe9essayer dans quelques instants.",AI_SERVICE_ERROR:"Mon service d'intelligence artificielle rencontre des difficult\xe9s. Veuillez patienter un peu avant de r\xe9essayer.",network:"Erreur de connexion. Veuillez v\xe9rifier votre connexion internet.",server:"Erreur serveur. Nos \xe9quipes ont \xe9t\xe9 notifi\xe9es.",validation:"Veuillez corriger les erreurs dans le formulaire.",unauthorized:"Vous n'\xeates pas autoris\xe9 \xe0 acc\xe9der \xe0 cette ressource.",not_found:"La page demand\xe9e n'existe pas.",forbidden:"Acc\xe8s interdit \xe0 cette resource."}};async function p(e){if(e.response)try{let s=await e.response.json(),t=s.error?.code;if(t&&h.errors[t])return h.errors[t]}catch(e){return h.errors.UNKNOWN_ERROR}return e.message.includes("Failed to fetch")?h.errors.network:h.errors.UNKNOWN_ERROR}class f{async sendMessage(e,s){let t=await fetch(`${this.baseUrl}/message`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,userId:s})});if(!t.ok)throw Error(`Erreur ${t.status}: ${t.statusText}`);return t.json()}async getChatHistory(e){let s=await fetch(`${this.baseUrl}/history?userId=${e}`);if(!s.ok)throw Error(`Erreur ${s.status}: ${s.statusText}`);return s.json()}async saveMemory(e,s,t="general"){let r=await fetch(`${this.baseUrl}/memory`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,memory:s,type:t})});if(!r.ok)throw Error(`Erreur ${r.status}: ${r.statusText}`);return r.json()}async resetConversation(e){let s=await fetch(`${this.baseUrl}/reset`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})});if(!s.ok)throw Error(`Erreur ${s.status}: ${s.statusText}`);return s.json()}async analyzeDocument(e,s,t="other"){let r=await fetch(`${this.baseUrl}/analyze-document`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({document:e,userId:s,documentType:t})});if(!r.ok)throw Error(`Erreur ${r.status}: ${r.statusText}`);return r.json()}async getUserMemory(e){let s=await fetch(`${this.baseUrl}/memory/${e}`);if(!s.ok)throw Error(`Erreur ${s.status}: ${s.statusText}`);return s.json()}async updateUserMemory(e,s){let t=await fetch(`${this.baseUrl}/memory/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({memoryUpdate:s})});if(!t.ok)throw Error(`Erreur ${t.status}: ${t.statusText}`);return t.json()}async healthCheck(){let e=await fetch("/api/health");if(!e.ok)throw Error(`Service indisponible: ${e.status}`);return e.json()}constructor(){this.baseUrl="/api/chat"}}new f;let g=e=>{let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/6e4),r=Math.floor(t/60),a=Math.floor(r/24);return t<1?"\xc0 l'instant":t<60?`Il y a ${t} min`:r<24?`Il y a ${r}h`:a<7?`Il y a ${a} jour${a>1?"s":""}`:s.toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})},b=e=>{let s=new Date(e);return new Date().getTime()-s.getTime()<3e5};function j({userId:e,className:s="",initialMessage:c,userContext:h}){let[f,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(!1),y=(0,a.useRef)(null),w=(0,a.useRef)(null),{messages:D,isLoading:C,error:E,connectionStatus:S,sendMessage:k,resetConversation:P,saveMemory:$,retry:_,isEmpty:A}=function(e={}){let{userId:s,autoLoadHistory:r=!0,userContext:n}=e,[o,i]=(0,a.useState)({messages:[],isLoading:!1,error:null,connectionStatus:"disconnected"}),l=(0,a.useRef)(null),c=(0,a.useCallback)(async()=>{if(!s){i(e=>({...e,isLoading:!1,connectionStatus:"disconnected"}));return}try{i(e=>({...e,isLoading:!0,connectionStatus:"connecting"}));let e=await fetch(`/api/chat/history?userId=${s}`);if(!e.ok)throw{response:e};let t=await e.json();i(e=>({...e,messages:t.messages||[],isLoading:!1,connectionStatus:"connected",error:null}))}catch(s){console.error("Erreur chargement historique:",s);let e=await p(s);i(s=>({...s,isLoading:!1,connectionStatus:"disconnected",error:e}))}},[s]),d=(0,a.useCallback)(async e=>{if(!e.trim()||o.isLoading||!s)return;l.current&&l.current.abort(),l.current=new AbortController;let r={id:`user-${Date.now()}`,role:"user",content:e.trim(),timestamp:new Date().toISOString()};i(e=>({...e,messages:[...e.messages,r],isLoading:!0,error:null}));try{let{supabase:r}=await Promise.resolve().then(t.bind(t,24)),{data:{session:a}}=await r.auth.getSession(),o=a?.access_token;if(!o)throw Error("Session expir\xe9e");let c=await fetch("/api/chat/message",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({message:e.trim(),userId:s,context:n}),signal:l.current.signal});if(!c.ok)throw{response:c};let d=await c.json(),u={id:`assistant-${Date.now()}`,role:"assistant",content:d.response||d.answer,timestamp:d.timestamp,sources:d.sources||[],processing_time:d.processing_time||0,suggestions:d.suggestions||[]};i(e=>({...e,messages:[...e.messages,u],isLoading:!1,connectionStatus:"connected"}))}catch(s){if("AbortError"===s.name)return;console.error("Erreur envoi message:",s);let e=await p(s);i(s=>({...s,isLoading:!1,connectionStatus:"disconnected",error:e}))}},[s,o.isLoading]),u=(0,a.useCallback)(async()=>{if(s)try{if(i(e=>({...e,isLoading:!0})),!(await fetch("/api/chat/reset",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s})})).ok)throw Error("Erreur lors de la r\xe9initialisation");i(e=>({...e,messages:[],isLoading:!1,error:null}))}catch(e){console.error("Erreur reset:",e),i(s=>({...s,isLoading:!1,error:e.message}))}},[s]),m=(0,a.useCallback)(async(e,t="important")=>{if(!s)return!1;try{if(!(await fetch("/api/chat/memory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s,memory:e,type:t})})).ok)throw Error("Erreur sauvegarde m\xe9moire");return!0}catch(e){return console.error("Erreur sauvegarde m\xe9moire:",e),!1}},[s]),x=(0,a.useCallback)(async(e,t)=>{if(!s)return null;try{i(e=>({...e,isLoading:!0}));let r=await fetch("/api/chat/analyze-document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({document:e,userId:s,documentType:t})});if(!r.ok)throw Error("Erreur analyse document");let a=await r.json(),n={id:`analysis-${Date.now()}`,role:"assistant",content:`ðŸ“„ **Analyse de votre document :**

${a.analysis}

**Suggestions :**
${a.suggestions.map(e=>`â€¢ ${e}`).join("\n")}`,timestamp:new Date().toISOString()};return i(e=>({...e,messages:[...e.messages,n],isLoading:!1})),a}catch(e){return console.error("Erreur analyse document:",e),i(s=>({...s,isLoading:!1,error:e.message})),null}},[s]),h=(0,a.useCallback)(()=>{if(o.messages.length>0){let e=[...o.messages].reverse().find(e=>"user"===e.role);e&&(i(e=>({...e,messages:e.messages.filter(e=>!e.id.startsWith("error-")),error:null})),d(e.content))}},[o.messages,d]);return{messages:o.messages,isLoading:o.isLoading,error:o.error,connectionStatus:o.connectionStatus,sendMessage:d,resetConversation:u,saveMemory:m,analyzeDocument:x,loadChatHistory:c,retry:h,isEmpty:0===o.messages.length,lastMessage:o.messages[o.messages.length-1]||null}}({userId:e,autoLoadHistory:!0,userContext:h});if(!e)return r.jsx("div",{className:`flex items-center justify-center h-full bg-slate-50 ${s}`,children:(0,r.jsxs)("div",{className:"text-center max-w-md space-y-4",children:[r.jsx("div",{className:"w-16 h-16 bg-rose-100 rounded-full flex items-center justify-center mx-auto",children:r.jsx(n.Z,{className:"h-8 w-8 text-rose-500"})}),r.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Session expir\xe9e"}),r.jsx("p",{className:"text-slate-600",children:"Merci de vous reconnecter pour continuer \xe0 discuter avec Phoenix. Votre s\xe9curit\xe9 passe avant tout."})]})});let I=async e=>{if(e.preventDefault(),!f.trim()||C)return;let s=f.trim();j(""),N(!1),await k(s)},T=async e=>{let s={hello:"Bonjour Phoenix, j'aurais besoin d'aide pour accompagner mon enfant.",aeeh_calc:"Mon enfant a un handicap. Puis-je avoir l'AEEH et \xe0 combien ai-je droit ?",parent_solo:"Je suis parent isol\xe9 avec un enfant handicap\xe9. Quelles majorations puis-je avoir ?",aesh_demande:"Mon enfant entre \xe0 l'\xe9cole. Comment demander un AESH ?",dossier_mdph:"Je dois constituer un dossier MDPH. Quels documents dois-je pr\xe9parer ?",cumul_aides:"Puis-je cumuler AEEH, allocations familiales et ARS ?",recours_mdph:"Ma demande MDPH a \xe9t\xe9 refus\xe9e. Comment faire un recours ?",caf_handicap:"Quelles aides de la CAF existent pour les familles avec enfant handicap\xe9 ?",transport:"Comment obtenir un transport scolaire adapt\xe9 pour mon enfant ?"}[e];s&&(j(""),N(!1),await k(s))},M=({message:e,index:s})=>{let t="user"===e.role,a=b(e.timestamp);return r.jsx("div",{className:`flex ${t?"justify-end":"justify-start"} mb-4`,children:(0,r.jsxs)("div",{className:`
          max-w-[85%] rounded-2xl px-4 py-3 relative
          ${t?"bg-rose-500 text-white":"bg-white shadow-sm border border-slate-200"}
          ${a?"animate-in slide-in-from-bottom-2 duration-300":""}
        `,children:[!t&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(n.Z,{className:"h-4 w-4 text-rose-500"}),r.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Phoenix"}),r.jsx("span",{className:"text-xs text-slate-500",children:"â€¢ Conseiller expert"})]}),r.jsx("div",{className:`prose prose-sm max-w-none leading-relaxed ${t?"text-white":"text-slate-800"}`,children:r.jsx(x.UG,{children:e.content})}),!t&&e.sources&&e.sources.length>0&&(0,r.jsxs)("div",{className:"mt-3 pt-2 border-t border-slate-100",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"\uD83D\uDCDA Sources consult\xe9es :"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:e.sources.map((e,s)=>(0,r.jsxs)("span",{className:"inline-block bg-blue-50 text-blue-700 px-2 py-1 rounded text-xs border border-blue-200",children:["\uD83D\uDCC4 ",e.length>40?e.substring(0,40)+"...":e]},s))})]}),!t&&e.suggestions&&e.suggestions.length>0&&(0,r.jsxs)("div",{className:"mt-3 pt-2 border-t border-slate-100",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"\uD83D\uDCA1 Questions sugg\xe9r\xe9es :"}),r.jsx("div",{className:"flex flex-col gap-2",children:e.suggestions.map((e,s)=>r.jsx("button",{onClick:()=>{j(e),w.current?.focus()},className:"text-left text-sm bg-rose-50 hover:bg-rose-100 text-rose-700 px-3 py-2 rounded-lg transition-colors border border-rose-200 hover:border-rose-300",children:e},s))})]}),(0,r.jsxs)("div",{className:`text-xs mt-2 ${t?"text-rose-100":"text-slate-400"}`,children:[g(e.timestamp),!t&&e.processing_time&&(0,r.jsxs)("span",{className:"ml-2",children:["â€¢ R\xe9ponse en ",e.processing_time.toFixed(1),"s"]})]}),!t&&s===D.length-1&&e.content.toLowerCase().includes("aeeh")&&(0,r.jsxs)("div",{className:"mt-3 pt-2 border-t border-slate-100",children:[r.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"\uD83D\uDCA1 Questions fr\xe9quentes ensuite :"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[r.jsx("button",{onClick:()=>k("Combien de temps pour avoir une r\xe9ponse MDPH ?"),className:"text-xs bg-rose-50 text-rose-700 px-2 py-1 rounded hover:bg-rose-100 transition-colors",children:"â±ï¸ D\xe9lais MDPH ?"}),r.jsx("button",{onClick:()=>k("Puis-je cumuler AEEH et allocations familiales ?"),className:"text-xs bg-rose-50 text-rose-700 px-2 py-1 rounded hover:bg-rose-100 transition-colors",children:"\uD83D\uDD04 Cumul possibles ?"}),r.jsx("button",{onClick:()=>k("Comment faire un recours si refus AEEH ?"),className:"text-xs bg-rose-50 text-rose-700 px-2 py-1 rounded hover:bg-rose-100 transition-colors",children:"âš–ï¸ En cas de refus ?"})]})]}),!t&&s===D.length-1&&r.jsx("button",{onClick:()=>$(e.content,"helpful_response"),className:"absolute -bottom-2 -right-2 bg-rose-100 hover:bg-rose-200 text-rose-600 rounded-full p-1 transition-colors",title:"Sauvegarder cette r\xe9ponse",children:r.jsx(n.Z,{className:"h-3 w-3"})})]})})},O=()=>(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 p-4 bg-slate-50 rounded-lg mb-4",children:[(0,r.jsxs)("button",{onClick:()=>T("aeeh_calc"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"\uD83D\uDCB0 Calculer AEEH"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Montants & \xe9ligibilit\xe9"})]}),(0,r.jsxs)("button",{onClick:()=>T("parent_solo"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"\uD83D\uDC69â€\uD83D\uDC67 Parent isol\xe9"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Majorations sp\xe9ciales"})]}),(0,r.jsxs)("button",{onClick:()=>T("aesh_demande"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"\uD83C\uDFEB Demander AESH"}),r.jsx("div",{className:"text-sm text-slate-600",children:"\xc9cole & accompagnement"})]}),(0,r.jsxs)("button",{onClick:()=>T("dossier_mdph"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"\uD83D\uDCCB Dossier MDPH"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Documents & d\xe9marches"})]}),(0,r.jsxs)("button",{onClick:()=>T("cumul_aides"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"\uD83D\uDD04 Cumul d'aides"}),r.jsx("div",{className:"text-sm text-slate-600",children:"AEEH + CAF + autres"})]}),(0,r.jsxs)("button",{onClick:()=>T("recours_mdph"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"âš–ï¸ Recours MDPH"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Refus & contestation"})]}),(0,r.jsxs)("button",{onClick:()=>T("caf_handicap"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"\uD83C\uDFDBï¸ Aides CAF"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Allocations familiales"})]}),(0,r.jsxs)("button",{onClick:()=>T("transport"),className:"p-3 text-left rounded-xl border border-slate-200 hover:border-rose-300 hover:bg-white transition-all",children:[r.jsx("div",{className:"font-medium text-slate-800",children:"\uD83D\uDE8C Transport adapt\xe9"}),r.jsx("div",{className:"text-sm text-slate-600",children:"\xc9cole & d\xe9placements"})]})]});return(0,r.jsxs)("div",{className:`flex flex-col h-full bg-slate-50 ${s}`,children:[r.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-rose-100 rounded-full flex items-center justify-center",children:r.jsx(n.Z,{className:"h-5 w-5 text-rose-500"})}),(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"font-semibold text-slate-900",children:"Phoenix"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Votre assistant empathique"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx(()=>{let e={connected:{icon:o.Z,color:"text-green-500",text:"Connect\xe9"},connecting:{icon:i.Z,color:"text-yellow-500",text:"Connexion..."},disconnected:{icon:l.Z,color:"text-red-500",text:"D\xe9connect\xe9"}}[S],s=e.icon;return(0,r.jsxs)("div",{className:`flex items-center gap-2 text-sm ${e.color}`,children:[r.jsx(s,{className:`h-4 w-4 ${"connecting"===S?"animate-spin":""}`}),e.text]})},{}),r.jsx("button",{onClick:P,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",title:"Nouvelle conversation",children:r.jsx(d,{className:"h-4 w-4"})})]})]})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:[A&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-16 h-16 bg-rose-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(n.Z,{className:"h-8 w-8 text-rose-500"})}),r.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Bonjour ! Je suis Phoenix \uD83D\uDD4Aï¸"}),(0,r.jsxs)("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:[r.jsx("strong",{children:"Conseiller social expert"})," combinant l'expertise MDPH + CAF + droits parentaux. Je vous accompagne pour toutes vos d\xe9marches : AEEH, allocations, AESH, recours, et bien plus !"]}),r.jsx(O,{})]}),D.map((e,s)=>r.jsx(M,{message:e,index:s},e.id)),C&&r.jsx("div",{className:"flex justify-start mb-4",children:(0,r.jsxs)("div",{className:"bg-white shadow-sm border border-slate-200 rounded-2xl px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(n.Z,{className:"h-4 w-4 text-rose-500"}),r.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Phoenix"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[r.jsx(i.Z,{className:"h-4 w-4 text-slate-400 animate-spin"}),r.jsx("span",{className:"text-slate-600",children:"Phoenix r\xe9fl\xe9chit..."})]})]})}),E&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-700 mb-2",children:[r.jsx(l.Z,{className:"h-4 w-4"}),r.jsx("span",{className:"font-medium",children:"Oups, une difficult\xe9 technique"})]}),r.jsx("p",{className:"text-red-600 text-sm mb-3",children:E}),r.jsx("button",{onClick:_,className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1 rounded-md text-sm transition-colors",children:"R\xe9essayer"})]}),r.jsx("div",{ref:y})]}),(0,r.jsxs)("div",{className:"bg-white border-t border-slate-200 px-6 py-4",children:[v&&!A&&r.jsx(O,{}),(0,r.jsxs)("form",{onSubmit:I,className:"flex gap-3",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[r.jsx("textarea",{ref:w,value:f,onChange:e=>j(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),I(e))},placeholder:"\xc9crivez votre message \xe0 Phoenix...",className:"w-full px-4 py-3 pr-12 border border-slate-300 rounded-xl resize-none focus:ring-2 focus:ring-rose-300 focus:border-rose-300 focus:outline-none transition-all",rows:1,style:{minHeight:"50px",maxHeight:"120px"},disabled:C}),!A&&r.jsx("button",{type:"button",onClick:()=>N(!v),className:"absolute right-3 top-3 p-1 text-slate-400 hover:text-slate-600 transition-colors",title:"Actions rapides",children:r.jsx(u.Z,{className:"h-4 w-4"})})]}),r.jsx("button",{type:"submit",disabled:!f.trim()||C,className:"bg-rose-500 hover:bg-rose-600 disabled:bg-slate-300 disabled:cursor-not-allowed text-white p-3 rounded-xl transition-colors focus:ring-2 focus:ring-rose-300 focus:outline-none",children:C?r.jsx(i.Z,{className:"h-5 w-5 animate-spin"}):r.jsx(m,{className:"h-5 w-5"})})]}),r.jsx("div",{className:"text-xs text-slate-500 mt-2 text-center",children:"Phoenix garde en m\xe9moire vos conversations pour mieux vous accompagner"})]})]})}var v=t(1955),N=t(6153),y=t(6614);function w(){let{user:e,loading:s}=(0,v.K)(),t=(0,N.useSearchParams)().get("q"),{aides:a}=(0,y.fN)(),{documents:n}=(0,y.GK)(),{deadlines:o}=(0,y.hT)(),{profile:i}=(0,y.mH)();return s?r.jsx("div",{className:"h-screen flex items-center justify-center bg-slate-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-rose-500 mx-auto mb-4"}),r.jsx("p",{className:"text-slate-600",children:"Chargement..."})]})}):r.jsx("div",{className:"h-screen",children:r.jsx(j,{userId:e?.id||"anonymous",initialMessage:t||void 0,userContext:{aides:a,documents:n,deadlines:o,profile:i}})})}},5712:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var r=t(9899),a=t(5507),n=t(4175),o=t(6153),i=t(7866),l=t(4767),c=t(4941),d=t(7282),u=t(1955),m=t(8449);function x(){let[e,s]=(0,a.useState)(!0);return e?r.jsx("div",{className:"bg-gradient-to-r from-rose-50 to-pink-50 border-b border-rose-100",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(i.Z,{className:"h-5 w-5 text-rose-500 flex-shrink-0"}),(0,r.jsxs)("p",{className:"text-sm text-slate-700",children:[r.jsx("span",{className:"font-medium",children:"Phoenix est gratuit"})," gr\xe2ce \xe0 la g\xe9n\xe9rosit\xe9 de familles comme vous.",r.jsx(n.default,{href:"/soutenir",className:"text-rose-600 hover:text-rose-700 ml-2 underline",children:"D\xe9couvrir comment soutenir â†’"})]})]}),r.jsx("button",{onClick:()=>s(!1),className:"text-slate-400 hover:text-slate-600 p-1","aria-label":"Fermer",children:r.jsx(m.Z,{className:"h-4 w-4"})})]})}):null}let h=({href:e,children:s})=>{let t=(0,o.usePathname)()===e;return r.jsx(n.default,{href:e,className:`flex items-center px-3 py-2 rounded-lg transition-colors ${t?"bg-rose-100 text-rose-700":"text-slate-600 hover:bg-slate-100"}`,children:s})};function p({children:e}){let{user:s,signOut:t,loading:a}=(0,u.K)();return((0,o.useRouter)(),a||!s)?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:r.jsx(i.Z,{className:"h-12 w-12 text-rose-500 animate-pulse"})}):(0,r.jsxs)("div",{className:"min-h-screen bg-slate-50 flex",children:[(0,r.jsxs)("aside",{className:"w-64 bg-white border-r border-slate-200 p-4 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-8",children:[r.jsx(i.Z,{className:"h-8 w-8 text-rose-500"}),r.jsx("span",{className:"text-xl font-semibold text-slate-900",children:"PhoenixCare"})]}),(0,r.jsxs)("nav",{className:"flex flex-col space-y-2",children:[(0,r.jsxs)(h,{href:"/chat",children:[r.jsx(l.Z,{className:"mr-3 h-5 w-5"}),"Assistant"]}),(0,r.jsxs)(h,{href:"/dashboard",children:[r.jsx(c.Z,{className:"mr-3 h-5 w-5"}),"Mon Dossier"]})]}),r.jsx("div",{className:"mt-auto",children:(0,r.jsxs)("div",{className:"border-t border-slate-200 pt-4",children:[r.jsx("p",{className:"text-sm font-medium text-slate-800 truncate",children:s?.user_metadata?.name||"Utilisateur"}),r.jsx("p",{className:"text-xs text-slate-500 truncate",children:s?.email}),(0,r.jsxs)("button",{onClick:t,className:"w-full flex items-center mt-4 px-3 py-2 rounded-lg text-slate-600 hover:bg-slate-100 transition-colors",children:[r.jsx(d.Z,{className:"mr-3 h-5 w-5"}),"Se d\xe9connecter"]})]})})]}),(0,r.jsxs)("main",{className:"flex-1 flex flex-col",children:[r.jsx(x,{}),r.jsx("div",{className:"flex-1",children:e})]})]})}},2341:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var r=t(9899);t(5599);var a=t(1955);function n({children:e}){return r.jsx(a.H,{children:e})}function o({children:e}){return r.jsx("html",{lang:"fr",children:r.jsx("body",{children:r.jsx(n,{children:e})})})}},1955:(e,s,t)=>{"use strict";t.d(s,{H:()=>i,K:()=>l});var r=t(9899),a=t(5507),n=t(24);let o=(0,a.createContext)(void 0);function i({children:e}){let[s,t]=(0,a.useState)(null),[i,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),u=async(e,s,t)=>{let{data:r,error:a}=await n.supabase.auth.signUp({email:e,password:s,options:{data:{name:t}}});return{data:r,error:a}},m=async(e,s)=>{let{data:t,error:r}=await n.supabase.auth.signInWithPassword({email:e,password:s});return{data:t,error:r}},x=async()=>{await n.supabase.auth.signOut()},h=async e=>{let{data:s,error:t}=await n.supabase.auth.resetPasswordForEmail(e);return{data:s,error:t}};return r.jsx(o.Provider,{value:{user:s,session:i,loading:c,signUp:u,signIn:m,signOut:x,resetPassword:h},children:e})}function l(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useSupabaseAuth must be used within an AuthProvider");return e}},6614:(e,s,t)=>{"use strict";t.d(s,{GK:()=>o,fN:()=>n,hT:()=>i,mH:()=>l});var r=t(5507);t(24);var a=t(1955);function n(){let{user:e}=(0,a.K)(),[s,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null);return{aides:s,loading:n,error:i}}function o(){let{user:e}=(0,a.K)(),[s,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null);return{documents:s,loading:n,error:i}}function i(){let{user:e}=(0,a.K)(),[s,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null);return{deadlines:s,loading:n,error:i}}function l(){let{user:e}=(0,a.K)(),[s,t]=(0,r.useState)(null),[n,o]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null);return{profile:s,children:n,loading:i,error:c}}},24:(e,s,t)=>{"use strict";t.d(s,{supabase:()=>o});var r=t(6873);let a="https://gvginoszwaccifrtackh.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd2Z2lub3N6d2FjY2lmcnRhY2toIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxMjQyNzgsImV4cCI6MjA3NDcwMDI3OH0.sbuGET5VLfo0VjwVugc_ix1F_b0ntqDVmrqckdP22ss";if(!a||!n)throw Error("Missing Supabase environment variables");let o=(0,r.eI)(a,n,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce",storage:{getItem:e=>null,setItem:(e,s)=>{},removeItem:e=>{}}}})},9290:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(2772).createProxy)(String.raw`/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/(protected)/chat/page.tsx#default`)},5474:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(2772).createProxy)(String.raw`/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/(protected)/layout.tsx#default`)},1163:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(2772).createProxy)(String.raw`/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/layout.tsx#default`)},5599:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[942,998,696,213],()=>t(7214));module.exports=r})();