"use strict";(()=>{var e={};e.id=216,e.ids=[216],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8523:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>g,patchFetch:()=>l,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var r={};s.r(r),s.d(r,{POST:()=>u});var o=s(3277),a=s(5265),n=s(5356),i=s(7076);let p=process.env.API_URL||process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000";async function u(e){try{let{message:t,userId:s,context:r}=await e.json(),o=(e.headers.get("Authorization")||"").replace("Bearer ","").trim();if(!o)return i.NextResponse.json({error:{code:"UNAUTHORIZED",message:"Authentification requise"}},{status:401});console.log(`ðŸ“¨ Requ\xeate chat: ${t.substring(0,50)}... (user: ${s})`);let a=await fetch(`${p}/api/chat/send`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({message:t,user_id:s,context:r||{}})});if(!a.ok)throw Error(`RAG Error: ${a.status}`);let n=await a.json();return i.NextResponse.json({response:n.answer||n.response,timestamp:n.timestamp,sources:n.sources||[],suggestions:n.suggestions||[],processing_time:n.processing_time})}catch(e){return console.error("Erreur API chat:",e),i.NextResponse.json({error:{code:"RAG_ERROR",message:"Erreur lors du traitement de votre message"}},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/chat/message/route",pathname:"/api/chat/message",filename:"route",bundlePath:"app/api/chat/message/route"},resolvedPagePath:"/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/api/chat/message/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:m}=c,g="/api/chat/message/route";function l(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[942,786],()=>s(8523));module.exports=r})();