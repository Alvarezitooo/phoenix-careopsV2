"use strict";(()=>{var e={};e.id=216,e.ids=[216],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8523:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>l,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{POST:()=>p});var a=r(3277),o=r(5265),n=r(5356),i=r(7076);let u=process.env.PYTHON_API_URL||"http://localhost:8000";async function p(e){try{let{message:t,userId:r,context:s}=await e.json(),a=(e.headers.get("Authorization")||"").replace("Bearer ","").trim();if(!a)return i.NextResponse.json({error:{code:"UNAUTHORIZED",message:"Authentification requise"}},{status:401});console.log(`ðŸ“¨ Requ\xeate chat: ${t.substring(0,50)}... (user: ${r})`);let o=await fetch(`${u}/api/chat/send`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({message:t,user_id:r,context:s||{}})});if(!o.ok)throw Error(`RAG Error: ${o.status}`);let n=await o.json();return i.NextResponse.json({response:n.answer||n.response,timestamp:n.timestamp,sources:n.sources||[],suggestions:n.suggestions||[],processing_time:n.processing_time})}catch(e){return console.error("Erreur API chat:",e),i.NextResponse.json({error:{code:"RAG_ERROR",message:"Erreur lors du traitement de votre message"}},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/chat/message/route",pathname:"/api/chat/message",filename:"route",bundlePath:"app/api/chat/message/route"},resolvedPagePath:"/Users/mattvaness/Desktop/IA/phoenix-careops/client/app/api/chat/message/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:m}=c,g="/api/chat/message/route";function l(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[942,786],()=>r(8523));module.exports=s})();